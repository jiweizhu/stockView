<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EasyUI DataGrid 横竖翻转</title>
    <link href="https://www.jeasyui.com/easyui/themes/default/easyui.css" rel="stylesheet" type="text/css">
    <link href="https://www.jeasyui.com/easyui/themes/icon.css" rel="stylesheet" type="text/css">
    <link href="themes/demo.css" rel="stylesheet" type="text/css">
    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script src="js/jquery.easyui.min.js" type="text/javascript"></script>
    <script src="js/jquery.edatagrid.js" type="text/javascript"></script>
    <script src="js/datagrid-detailview.js" type="text/javascript"></script>
</head>
<body>
<table id="datagrid" class="easyui-datagrid" style="width:600px;height:400px;"></table>
<button id="rotate" style="margin-top:10px;">横竖翻转</button>
<script>
    $(function () {
    // 初始数据
    const originalData = {
        total: 5,
        rows: [
            { field1: "张三", field2: "男", field3: "25", field4: "程序员" },
            { field1: "李四", field2: "女", field3: "28", field4: "设计师" },
            { field1: "王五", field2: "男", field3: "22", field4: "产品经理" }
        ]
    };

    const columns = [
        { field: 'field1', title: '姓名', width: 100 },
        { field: 'field2', title: '性别', width: 100 },
        { field: 'field3', title: '年龄', width: 100 },
        { field: 'field4', title: '职业', width: 100 }
    ];

    // 初始化 DataGrid
    $('#datagrid').datagrid({
        columns: [columns],
        data: originalData.rows,
        fitColumns: true,
        pagination: false,
        singleSelect: true
    });

    // 横竖翻转逻辑
    $('#rotate').on('click', function () {
        const isFlipped = $('#datagrid').data('flipped');
        if (isFlipped) {
            resetGrid(); // 恢复默认表格
        } else {
            transposeGrid(); // 横竖翻转表格
        }
        $('#datagrid').data('flipped', !isFlipped);
    });

    // 横竖翻转表格
    function transposeGrid() {
        const transposedColumns = [{ field: 'field', title: '字段名', width: 100 }];
        const transposedRows = [];

        // 将列转成行
        columns.forEach(col => {
            const newRow = { field: col.title };
            originalData.rows.forEach((row, index) => {
                const newField = `col${index + 1}`;
                transposedColumns.push({ field: newField, title: `记录${index + 1}`, width: 100 });
                newRow[newField] = row[col.field];
            });
            transposedRows.push(newRow);
        });

        // 重载表格
        $('#datagrid').datagrid({
            columns: [transposedColumns],
            data: transposedRows,
            fitColumns: true,
            pagination: false,
            singleSelect: true
        });
    }

    // 恢复原始表格
    function resetGrid() {
        $('#datagrid').datagrid({
            columns: [columns],
            data: originalData.rows,
            fitColumns: true,
            pagination: false,
            singleSelect: true
        });
    }
});
</script>
<script src="transpose-grid.js"></script>
</body>
</html>
